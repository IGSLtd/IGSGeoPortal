<script>
var map;require(["esri/map","esri/tasks/locator","esri/request","esri/InfoTemplate","esri/graphic","esri/symbols/PictureMarkerSymbol","esri/geometry/Multipoint","dojo/keys","dojo/on","dojo/dom","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/SpatialReference","dojo/domReady!"],function(e,t,a,n,o,i,r,c,s,l){"use strict";function d(e){var t,a=document.getElementById("cat"),n=e.addresses.length;if(0==n)m();else for(var o,i,r=0;r<n;r++)if(t=e.addresses[r],(o=t.attributes.PlaceName)!=i){var c=document.createElement("option");c.value=o,c.innerHTML=o,a.appendChild(c),i=o}}function m(){var e=document.getElementById("cat"),t=document.createElement("option");t.value=document.getElementById("noData").textContent,t.innerHTML=document.getElementById("noData").textContent,e.appendChild(t)}function g(e){var t;for(t=e.options.length-1;t>=0;t--)e.remove(t)}function p(){f(),g(document.getElementById("cat"));var e;l.byId("useMapExtent").checked&&(e=map.extent);var t={address:{category:l.byId("cat").value},outFields:["Place_addr","PlaceName","AgeOnegl"],searchExtent:e,location:map.extent.getCenter(),distance:1};x.addressToLocations(t)}function y(e){if(e.addresses.length>0){f(),d(e);for(var t,a,i,r,c,s,l,g,p=0;p<e.addresses.length;p++)t=(r=e.addresses[p]).attributes.Place_addr,a=r.attributes.PlaceName,i=r.attributes.AgeOnegl,l=r.location,r.attributes.Place_addr?"${address}<br/>":"",c={name:r.attributes.PlaceName,address:r.attributes.Place_addr,score:r.score,lat:l.y.toFixed(5),lon:l.x.toFixed(5)},s=new n('<img id="igs-alert-icon" src="http://igs-geodata.com/resources/images/favicon.ico" height="20" width="20" style=" margin-right: 10px;"/><span id="alert-title-text style"margin-right: 20px; "><b>'+r.address+"</b></span>","<b>RCS:</b> "+t+"<br/><b>RCS_D:</b> "+a+"<br/><b>AGE_ONEGL:</b> "+i),g=new o(l,w,c,s),map.graphics.add(g);u(e.addresses)}else alert(document.getElementById("noData").textContent),m()}function b(e){alert(document.getElementById("noData").textContent),m()}function u(e){h(e)}function h(e){for(var t=new Array(e.length),a=0;a<e.length;a++)t.push(e[a].location.x+","+e[a].location.y);var n=new esri.geometry.Polygon(new esri.SpatialReference({wkid:4326}));n.addRing([t]),n.spatialReference=map.spatialReference,console.log("Created polygons.");var o=(new esri.symbol.SimpleFillSymbol).setStyle(esri.symbol.SimpleFillSymbol.STYLE_SOLID),i=new esri.Graphic(n,o,{keeper:!0}),r=new esri.layers.GraphicsLayer({id:"poly"});map.addLayer(r),r.add(i),console.log("Polygons added on the map.")}function f(){map.infoWindow.hide(),map.graphics.clear()}function v(e,t,a,n,o){return new i({angle:0,xoffset:t,yoffset:a,type:"esriPMS",url:e,contentType:"image/png",width:n,height:o})}var I=(map=new e("mapDiv",{basemap:"national-geographic",center:[-.761248,54.430794],zoom:9})).infoWindow;I.highlight=!1,I.titleInBody=!1,I.domNode.className+=" light";var w=new v("//esri.github.io/quickstart-map-js/images/blue-pin.png",0,12,13,24),x=new t("${pageUrl}");s(map,"load",function(){s(x,"address-to-locations-complete",y),s(x,"error",b),s(l.byId("btnSearch"),"click",p),s(l.byId("btnClear"),"click",f),s(l.byId("cat"),"change",function(e){p()}),p()}),window.zoomToPlace=function(e,t){var a=map.getLevel();a=a<14?14:a+1,map.centerAndZoom([e,t],a)},s(l.byId("btnStreets"),"click",function(){pageLoad()}),s(l.byId("btnSatellite"),"click",function(){changeTab("satellite")}),s(l.byId("btnHybrid"),"click",function(){changeTab("hybrid")}),s(l.byId("btnTopo"),"click",function(){changeTab("topo")}),s(l.byId("btnGray"),"click",function(){changeTab("gray")}),s(l.byId("btnNatGeo"),"click",function(){changeTab("national-geographic")})});
</script>

<script type="text/javascript">
function pageLoad(){map.setBasemap("streets"),document.getElementById("btnStreets").style.backgroundColor="#ebebeb"}function changeTab(e){map.setBasemap(e);var t=document.getElementById("btnStreets");"btnStreets"!=e&&(t.style.backgroundColor="#fff")}
</script>